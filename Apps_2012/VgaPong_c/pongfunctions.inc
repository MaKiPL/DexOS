;=========================================================;
; PongFunctions                                  00/00/05 ;
;---------------------------------------------------------;
;=======================================================  ;
;  rand                                                   ;
;=======================================================  ;
rand:							  ;
	mov	ax,[Seed]				  ;
	imul	[k1]					  ;
	add	ax,[k2] 				  ;
	mov	[Seed],ax				  ;
	ror	al,1					  ;
	rol	ah,1					  ;
	ret						  ;
							  ;
;=======================================================  ;
;  PutPix                                                 ;
;=======================================================  ;
PutPix: 						  ;
	push	ecx					  ;
	xor	ecx,ecx 				  ;
	mov	edi,ScreenBuffer			  ;
	mov	cx,ax					  ;
	mov	dx,bx					  ;
	shl	bx,8					  ;
	shl	dx,6					  ;
	add	bx,dx					  ;
	add	cx,bx					  ;
	add	edi,ecx 				  ;
	pop	ecx					  ;
	ret						  ;
							  ;
;=======================================================  ;
;  PutPix                                                 ;
;=======================================================  ;
DrawImage1:						  ;
	mov	dl,[Row]				  ;
	cld						  ;
GetData1:						  ;
	lodsw						  ;
	mov	bx,ax					  ;
	mov	cl,16					  ;
CheckBit1:						  ;
	test	bx,0x8000				  ;
	jz	ZeroBit1				  ;
	mov	al,[Color]				  ;
	stosb						  ;
	jmp	Skip1					  ;
ZeroBit1:						  ;
	inc	edi					  ;
Skip1:							  ;
	shl	bx,1					  ;
	loop	CheckBit1				  ;
	add	edi,304 				  ;
	dec	dl					  ;
	jnz	GetData1				  ;
	ret						  ;
							  ;
;=======================================================  ;
;  Sound                                                  ;
;=======================================================  ;
Sound:							  ;
	mov	bx,[Hz] 				  ;
	mov	ax,0x34dd				  ;
	mov	dx,0x0012				  ;
	cmp	dx,bx					  ;
	jnc	Done1					  ;
	div	bx					  ;
	mov	bx,ax					  ;
	in	al,0x61 				  ;
	test	al,3					  ;
	jnz	A99					  ;
	or	al,3					  ;
	out	0x61,al 				  ;
	mov	al,0xb6 				  ;
	out	0x43,al 				  ;
A99:							  ;
	mov	al,bl					  ;
	out	0x42,al 				  ;
	mov	al,bh					  ;
	out	0x42,al 				  ;
Done1:							  ;
	ret						  ;
							  ;
;=======================================================  ;
; NoSound                                                 ;
;=======================================================  ;
NoSound:						  ;
	in	al,0x61 				  ;
	and	al,11111100b				  ;
	out	0x61,al 				  ;
	ret						  ;
							  ;
;=======================================================  ;
;  FullVertWait                                           ;
;=======================================================  ;
FullVertWait:						  ;
	mov	dx,0x03da				  ;
Vr:							  ;
	in	al,dx					  ;
	test	al,8					  ;
	jnz	Vr					  ; wait until Verticle Retrace starts
Nvr:							  ;
	in	al,dx					  ;
	test	al,8					  ;
	jz	Nvr					  ; wait until Verticle Retrace Ends
	ret						  ;
							  ;
;=======================================================  ;
;   Data                                                  ;
;=======================================================  ;
							  ;
Seed			dw	      0 		  ;
k1			dw	      9821		  ;
k2			dw	      1 		  ;